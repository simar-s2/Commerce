{% extends "auctions/layout.html" %}

{% block body %}
    <h2>{{ listing.title }}</h2>
    {% if not watchlist %}
    <form action="{% url 'add_remove_watchlist' listing_id=listing.id %}" method="post">
        {% csrf_token %}
        <input class="btn btn-success" type="submit" value="Add to watchlist" name="action">
    </form>
    {% else %}
    <form action="{% url 'add_remove_watchlist' listing_id=listing.id %}" method="post">
        {% csrf_token %}
        <input class="btn btn-danger" type="submit" value="Remove from watchlist" name="action">
    </form>
    {% endif %}
    <br>
    <div>
        {% if listing.image %}
        <img src="{{ listing.image }}" alt="{{ listing.title }}" width="300px">
        {% endif %}
        <h2>Details</h2>
        <p><strong>Description: </strong>{{ listing.description }}</p>
        <p>
            <strong>Current Price: </strong>
            {% if not last_bid %}
            {{ listing.price }}
            {% else %}
            {{ last_bid.bid }}
            {% endif %}
        </p>
        <p>Posted by: <strong>{{ listing.owner }}</strong></p>
    </div>
    <br>
    {% if user == listing.owner %}
    {% else %}
    <h2>Bid</h2>
    <form action="{% url 'bid' listing_id=listing.id %}" method="post">
        <div class="form-group">
            {% csrf_token %}
            {{ Bidform }}
            <br>
            <input class="btn btn-primary" type="submit" value="Bid">
        </div>
    </form>
    <br>
    {% endif %}
    <h2>Comments</h2>
    <form action="{% url 'add_comment' listing_id=listing.id %}" method="post">
        <div class="form-group">
            {% csrf_token %}
            {{ Commentform }}
            <br>
            <input class="btn btn-primary" type="submit" value="Add Comment">
        </div>
    </form>
    {% for comment in comments %}
    <p>Posted by <strong>{{ comment.user }}</strong></p>
    <p>{{ comment.comment }}</p>
    {% endfor %}
{% endblock %}
